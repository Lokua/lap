!function(a,b){function c(a){var b=a.settings,c=b.width,d=b.height,e=c/2,f=d/2,g=a.paper,h=g.set(),i=e+e/2,j=g.rect(0,0,i,i),k=g.rect(e-e/2,f-f/2,i,i);return j.node.id=a.idf+"discog-box1-"+a.lap.id,k.node.id=a.idf+"discog-box2-"+a.lap.id,h.push(j,k),h.attr({fill:b.fill,stroke:b.background,strokeWidth:2}),h}function d(a){var b=a.settings,c=b.width,d=b.height,e=c/2,f=d/2,g=a.paper,h=g.set(),i=g.circle(e,f,e).attr({fill:b.fill,stroke:b.stroke,strokeWidth:b.strokeWidth}),j={fill:b.background,stroke:"none"},k=2.5,l=g.circle(e,f/2,e/k/1.5).attr(j),m=g.rect(e-e/(2*k),f,e/k,f-f/4).attr(j);return i.node.id=a.idf+"info-circle-"+a.lap.id,l.node.id="lap-info-dot-"+a.lap.id,m.node.id="lap-info-rect-"+a.lap.id,h.push(i,l,m),h}function e(a){var b=a.settings,c=b.width,d=b.height,e=a.paper,f=e.set(),g=e.rect(0,0,c/3,d).attr(a.attrs),h=e.rect(c-c/3,0,c/3,d).attr(a.attrs);return g.node.id=a.idf+"pause-rect0-"+a.lap.id,h.node.id=a.idf+"pause-rect1-"+a.lap.id,f.push(g,h),f}function f(a){var b=a.settings,c=b.width,d=b.height,e=d/2,f=a.paper,g=f.path(["M",0,0,"L",c,e,"L",0,d,"z"]).attr(a.attrs);return g.node.id=a.idf+"play-"+a.lap.id,g}function g(a){var b=a.settings.width,c=a.settings.height,d=c/2,e=a.paper,f=e.set(),g=c/3.75,h=e.rect(0,0,b,g),i=e.rect(0,d-g/2,b,g),j=e.rect(0,c-g,b,g);return h.node.id=a.idf+"playlist-button-bar1-"+a.lap.id,i.node.id=a.idf+"playlist-button-bar2-"+a.lap.id,j.node.id=a.idf+"playlist-button-bar3-"+a.lap.id,f.push(h,i,j).attr(a.attrs),f}function h(a){var b=a.settings,c=b.seekRange,d=c.width,e=c.height,f=b.strokeWidth,g=a.lap,h=g.audio,i=!1,j=g.container,k=(a.$el,o(".lap-seek-range",j),e<b.height?(b.height-e)/2:0),l=6,m=a.paper;m.setSize(d+l,b.height);var p=m.set(),q=m.rect(l,k,d-l,e).attr({fill:c.trackFill,stroke:c.trackStroke,strokeWidth:f}),r=m.rect(l,k,n.scale(g.bufferFormatted(),0,100,l,d-l),e).attr({fill:c.levelFill,stroke:c.levelStroke,strokeWidth:f}),s="rect"===c.knobShape?m.rect(0,k,c.knobWidth,e):m.circle(0,b.height/2,c.knobWidth);return s.attr({fill:c.knobFill,stroke:c.knobStroke,strokeWidth:f}),p.push(q,r,s),q.node.id="lap-rc-seek-range-track"+a.lap.id,r.node.id="lap-rc-seek-range-progress"+a.lap.id,s.node.id="lap-rc-seek-range-playhead"+a.lap.id,p.mousedown(function(){i=!0}).mousemove(function(a){if(i){var b=a.offsetX<=l?l:a.offsetX;b=a.offsetX>=d-l?d-l:b,s.animate("rect"===c.knobShape?{x:b}:{cx:b})}}).mouseup(function(a){i&&(h.currentTime=n.scale(a.offsetX,0,d,0,h.duration),i=!1)}),h.addEventListener("progress",function(){r.animate({width:n.scale(g.bufferFormatted(),0,100,l,d-l)})}),h.addEventListener("timeupdate",function(){if(!i){var a=n.scale(h.currentTime,0,h.duration,l,d-l);s.animate("rect"===c.knobShape?{x:a}:{cx:a})}}),p}function i(a,b){var c,d=a.settings.width,e=a.settings.height,f=d/2,g=e/2,h=.15,i=a.paper,j=["M",0,g,"L",f,e*h,"L",f,g,"L",d,e*h,"L",d,e*(1-h),"L",f,g,"L",f,e*(1-h),"z"];return c=b?i.path(j).transform(["r",180,f,g]):i.path(j),c.attr(a.attrs),c.node.id=a.idf+"seek-"+(b?"forward-":"backward-")+a.lap.id,c}function j(a,b){var c=a.settings.width,d=a.settings.height,e=c/2,f=d/2,g=a.paper,h=g.set(),i=["M",0,0,"L",c,f,"L",0,d,"z"],j=b?g.path(i):g.path(i).transform(["r",180,e,f]),k=b?c-c/4:0,l=g.rect(k,0,c/4,d),m=b?"next-":"prev-";return j.node.id=a.idf+m+"tri-"+a.lap.id,l.node.id=a.idf+m+"rect-"+a.lap.id,h.push(j,l).attr(a.attrs),h}function k(a){var b=a.settings,c=b.width,d=b.height,e=c/2,f=d/2,g=a.paper,h=g.set(),i=g.path(["M",0,f/2,"H",e/2,"L",e+e/4,0,"V",d,"L",e/2,f+f/2,"H",0,"z"]).attr(a.attrs),j=1.5,k=3,l=["M",c-e/k,f/k,"C",c,f/j,c,d-f/j,c-e/k,d-f/k],m={fill:"none",stroke:b.fill,strokeWidth:b.strokeWidth,strokeLineCap:"round"},n=g.path(l).transform(["t",-2.5,0,"s",.6]).attr(m),o=g.path(l).attr(m);return i.node.id="lap-rcf-speaker-horn-"+a.lap.id,n.node.id="lap-rcs-speaker-curve2-"+a.lap.id,o.node.id="lap-rcs-speaker-curve3-"+a.lap.id,h.push(i,n,o),h}function l(a){var b=a.settings,c=b.volumeSlider,d=c.width,e=c.height,f=6,g=b.strokeWidth,h=a.lap.getSelector,i=a.lap.container,j=h(a.$el,i),k=h(".lap-volume-wrapper",i),l=a.paper,m=e<b.height?(b.height-e)/2:0;l.setSize(d,b.height);var o=l.set(),p=l.rect(0,m,d,e).attr({fill:c.trackFill,stroke:c.trackStroke,strokeWidth:g}),q=l.rect(0,m,d*a.lap.audio.volume,e).attr({fill:c.levelFill,stroke:c.levelStroke,strokeWidth:g}),r="rect"===c.knobShape?l.rect(d*a.lap.audio.volume-2,m,f,e):l.circle(d*a.lap.audio.volume-2,b.height/2,f);return r.attr({fill:c.knobFill,stroke:c.knobStroke,strokeWidth:g}),p.node.id="lap-rc-volume-track"+a.lap.id,q.node.id="lap-rc-volume-level"+a.lap.id,r.node.id="lap-rc-volume-knob"+a.lap.id,o.push(p,q,r),o.mousedown(function(b){a.sliding=!0,q.animate({width:b.offsetX},20),r.animate("rect"===c.knobShape?{x:b.offsetX-2}:{cx:b.offsetX-2},20)}).mousemove(function(b){if(a.sliding){var e=b.target.getBoundingClientRect(),g=(b.clientX-e.left)/e.width*this.attrs.width+this.getBBox().x,h=n.scale(g,0,d,0,1).toFixed(2);if(isNaN(g))return;g=g>=d-2?d:g,g=.05>=h?0:g,h=h>=.99?1:h,q.animate({width:g},20);var i=0===g?g:g-2;i=g===d?d-f:i;try{r.animate("rect"===c.knobShape?{x:i}:{cx:i},20)}catch(b){}.666>=h&&a.volumeButton[2].hide(),h>.666&&a.volumeButton[2].show(),.333>=h&&a.volumeButton[1].hide(),h>.333&&a.volumeButton[1].show();try{a.lap.audio.volume=h}catch(b){}}}).mouseup(function(){a.sliding=!1}),k.on("mouseenter",function(){j.removeClass("lap-hidden")}),k.on("mouseleave",function(){a.sliding||j.addClass("lap-hidden")}),o}function m(a,b){var c=a.settings,d=c.width,e=c.height,f=d/2,g=e/2,h=a.paper.path(["M",0,0,"L",d,g,"L",0,e,"z"]).transform(["r",b?-90:90,f,g]).attr(a.attrs);return h.node.id=a.idf+"volume-"+(b?"up-":"down-")+a.lap.id,h}var n=a.tooly||b.prototype.getTooly(),o=n.Frankie;b.RaphaelControls=function(a,b,c){this.lap=a;var d=24,e=4*d,f={width:e,height:d/4,trackFill:"#eee",trackStroke:"none",levelFill:"#888",levelStroke:"none",knobFill:"#fff",knobStroke:"#ddd",knobWidth:6,knobShape:"circle"},g={padding:2,width:d,height:d,background:"#fff",fill:"#000",stroke:"#000",strokeWidth:1,scale:!0,scaleAmount:.95,seekStyle:"buttons",seekRange:f,volumeStyle:"range",volumeRange:f};return this.settings=n.extend({},g,b),c&&this.init(),this},b.RaphaelControls.prototype=function(){return{init:function(){var a=this,b=a.lap,c=a.settings;return a.id="lap-rc-",a.idf="lap-rcf-",a.ids="lap-rcs-",a.sliding=!1,a.attrs={fill:c.fill,stroke:c.stroke,strokeWidth:c.strokeWidth},a.draw("playPause"),"range"===c.seekStyle?a.draw("seekRange"):(a.draw("seekBackward"),a.draw("seekForward")),a.draw("prev"),a.draw("next"),a.draw("info"),a.draw("playlist"),a.draw("discog"),"range"===c.volumeStyle?(a.draw("speaker"),a.draw("volumeRange")):(a.draw("volumeUp"),a.draw("volumeDown")),a.draw("download"),this.pause.hide(),b.registerCallbacks({togglePlay:function(){b.audio.paused?(a.pause.hide(),a.play.show()):(a.play.hide(),a.pause.show())}}),a},draw:function(a){try{if(this.$el=this.lap.$els[a],!(this.$el&&this.$el instanceof o)||this.$el.zilch())return this;this.$el=this.$el.get(0)}catch(b){}switch(this.paper=Raphael(this.$el,this.settings.width,this.settings.height),a){case"playPause":this.play=new f(this),this.pause=new e(this);break;case"seekRange":this.seekRange=new h(this);break;case"seekBackward":this.seekBackward=new i(this,!1);break;case"seekForward":this.seekForward=new i(this,!0);break;case"prev":this.prev=new j(this,!1);break;case"next":this.next=new j(this,!0);break;case"volumeUp":this.volumeUp=new m(this,!0);break;case"volumeDown":this.volumeDown=new m(this,!1);break;case"speaker":this.speaker=new k(this);break;case"volumeRange":this.volumeRange=new l(this);break;case"info":this.info=new d(this);break;case"playlist":this.playlist=new g(this);break;case"discog":this.discog=new c(this)}return this}}}()}(window,window.Lap);